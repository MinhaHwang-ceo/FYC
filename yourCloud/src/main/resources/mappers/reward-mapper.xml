<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="Reward">
	<resultMap type="com.kh.yc.reward.model.vo.Reward" id="RewardResultSet">
		<id property="rewardNo" column="REWARD_NO"/>
		<result property="rewardMoney" column="REWARD_MONEY"/>
		<result property="sortNo" column="SORT_NO"/>
		<result property="rewardName" column="REWARD_NAME"/>
		<result property="option" column="OPTIONS"/>
		<result property="deliveryRequest" column="DELIVERY_REQUEST"/>
		<result property="deliveryMoney" column="DELIVERY_MONEY"/>
		<result property="limitCount" column="ADMIN_NO"/>
		<result property="summary" column="LIMIT_COUNT"/>
		<result property="startDate" column="START_DATE"/>
		<result property="projectNo" column="PROJECT_NO"/>
		<result property="projectShortTitle" column="PROJECT_SHORT_TITLE"/>
		<result property="memberName" column="MEMBER_NAME"/>
		<result property="money" column="MONEY"/>
		<result property="description" column="DESCRIPTION"/>

		
		<result property="fundDate" column="FUND_DATE"/>
      	<result property="fundNo" column="FUND_NO"/>
      	<result property="fundMoney" column="FUND_MONEY"/>
      	<result property="account" column="ACCOUNT"/>
      	<result property="category" column="CATEGORY"/>
      	<result property="categoryDiv" column="CATEGORY_DIV"/>
    	<result property="endDate" column="END_DATE"/>
     	<result property="projectTitle" column="PROJECT_TITLE"/>
     	<result property="companyName" column="COMPANY_NAME"/>
     	<result property="deliverySite" column="DELIVERY_SITE"/>
      	<result property="deliveryMoney" column="DELIVERY_MONEY"/>
      	<result property="options" column="OPTIONS"/>
      	<result property="payStatus" column="PAY_STATUS"/>
		
</resultMap>
	
	<select id="viewReward" resultMap="RewardResultSet">
		SELECT *
		FROM REWARD
		WHERE
		PROJECT_NO= #{projectNo}
	</select>

	
	<insert id="insertReward" parameterType="Reward">
		INSERT INTO REWARD 
		VALUES (
				SEQ_REWARDNO.NEXTVAL,
				#{rewardMoney},
				#{sortNo},
				#{rewardName},
				#{option},
				#{deliveryRequest},
				#{deliveryMoney},
				#{limitCount},
				#{startDate},
				#{projectNo},
				#{description}
			   )
	</insert>
	<select id="selectMyReward" resultMap="RewardResultSet" parameterType="java.util.Map">
		SELECT M.MEMBER_NO, F.FUND_DATE, F.FUND_NO, PJ.PROJECT_NO, R.REWARD_NO, M.ACCOUNT,
				PJ.CATEGORY, C.CATEGORY_DIV, PJ.END_DATE, PJ.PROJECT_TITLE, M.COMPANY_NAME,
				D.DELIVERY_SITE, R.DELIVERY_MONEY, R.START_DATE, R.OPTIONS, R.REWARD_MONEY
		FROM MEMBER M
		LEFT JOIN PAYMENT PA ON(M.MEMBER_NO = PA.MEMBER_NO)
		LEFT JOIN FUND F ON(PA.MEMBER_NO = F.MEMBER_NO)
		LEFT JOIN PROJECT PJ ON(F.MEMBER_NO = PJ.MEMBER_NO)
		LEFT JOIN CATEGORY C ON(PJ.CATEGORY = C.CATEGORY)
		LEFT JOIN REWARD R ON(PJ.PROJECT_NO = R.PROJECT_NO)
		LEFT JOIN DELIVERY D ON(M.MEMBER_NO = D.MEMBER_NO)
		WHERE M.MEMBER_NO = #{userNo}
	</select>
</mapper>


